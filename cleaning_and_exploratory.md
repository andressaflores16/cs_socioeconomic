Data Cleaning and Exploratory Analysis
================
Andressa Flores Salvatierra
2024-07-01

## Basics

First we need to load the data that will be used. In the original
project 3 data sets were chosen: World Development Indicators (WDI),
Health Equity and Financial Protection Indicators (HEFPI) and Health
Nutrition and Population Statistics (HNPS).  
However, this totals to 2262 variables available, and considering that
there are many years of data available, it would all be too much to
handle. I’ve chosen to stick to WDI data set first, and see if I can
incorporate the other data sets later in the analysis, to gain further
insights.  
Below, previews of the two data sets that will be merged to compose the
final input data set. They are in long format (CHECK). First, we have
the dataset from the World Health Organization research team regarding
caesarean section rates worldwide:

``` r
cs_section_rates_raw <- read_csv("BETRAN2018_dados_v2.csv", col_names = TRUE, col_types = cols(
  "ISO Code" = col_character(),
  Country = col_character(),
  "Coverage start year" = col_integer(),
  "Coverage end year" = col_integer(),
  "Caesarean section rate (%)" = col_double()
))
```

    ## Warning: One or more parsing issues, call `problems()` on your data frame for details,
    ## e.g.:
    ##   dat <- vroom(...)
    ##   problems(dat)

``` r
glimpse(cs_section_rates_raw)
```

    ## Rows: 2,024
    ## Columns: 5
    ## $ `ISO Code`                   <chr> "AFG", "AFG", "AFG", "AFG", "ALB", "ALB",…
    ## $ Country                      <chr> "Afghanistan", "Afghanistan", "Afghanista…
    ## $ `Coverage start year`        <int> 2005, 2008, 2010, 2016, 1992, 1993, 1994,…
    ## $ `Coverage end year`          <int> 2010, 2011, 2015, 2018, 1992, 1993, 1994,…
    ## $ `Caesarean section rate (%)` <dbl> 5.0, 3.6, 2.7, 6.6, 9.3, 9.8, 7.8, 8.4, 8…

When checking for the parsing error, we can see that it’s only one line
and it’s essentially a missing value, so we’ll just leave as is for now
and filter these values later:

``` r
problems(cs_section_rates_raw)
```

    ## # A tibble: 1 × 5
    ##     row   col expected actual file 
    ##   <int> <int> <chr>    <chr>  <chr>
    ## 1  1614     5 a double <1.0   ""

Now for the World Development Indicators dataset from World Bank:

``` r
world_develop_indic_raw <- read_csv("dados/WDI_CSV/WDIData.csv", col_types = cols(
  "Country Name" = col_character(),
  "Country Code" = col_character(),
  "Indicator Name" = col_character(),
  "Indicator Code" = col_character()
))
```

    ## New names:
    ## • `` -> `...68`

``` r
glimpse(world_develop_indic_raw)
```

    ## Rows: 395,276
    ## Columns: 68
    ## $ `Country Name`   <chr> "Africa Eastern and Southern", "Africa Eastern and So…
    ## $ `Country Code`   <chr> "AFE", "AFE", "AFE", "AFE", "AFE", "AFE", "AFE", "AFE…
    ## $ `Indicator Name` <chr> "Access to clean fuels and technologies for cooking (…
    ## $ `Indicator Code` <chr> "EG.CFT.ACCS.ZS", "EG.CFT.ACCS.RU.ZS", "EG.CFT.ACCS.U…
    ## $ `1960`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1961`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1962`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1963`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1964`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1965`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1966`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1967`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1968`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1969`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1970`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1971`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1972`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1973`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1974`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1975`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1976`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1977`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1978`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1979`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1980`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1981`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1982`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1983`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1984`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1985`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1986`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1987`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1988`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1989`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1990`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1991`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1992`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1993`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1994`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1995`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1996`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1997`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1998`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `1999`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ `2000`           <dbl> 11.580366, 3.546244, 32.604500, 19.957302, 8.623497, …
    ## $ `2001`           <dbl> 11.907943, 3.713752, 32.964159, 19.975365, NA, 53.235…
    ## $ `2002`           <dbl> 12.285175, 3.904902, 33.409617, 21.576500, NA, 55.340…
    ## $ `2003`           <dbl> 12.607641, 4.093657, 33.791497, 22.529265, 9.765491, …
    ## $ `2004`           <dbl> 12.990589, 4.312080, 34.220485, 23.749531, 10.910243,…
    ## $ `2005`           <dbl> 13.394404, 4.530435, 34.727444, 23.493013, 10.442796,…
    ## $ `2006`           <dbl> 13.835255, 4.759641, 35.159518, 25.191221, 12.518041,…
    ## $ `2007`           <dbl> 14.2571198, 5.0041450, 35.6949836, 26.8079371, 12.527…
    ## $ `2008`           <dbl> 14.687203, 5.237581, 36.102188, 25.943316, 12.986509,…
    ## $ `2009`           <dbl> 15.124112, 5.483481, 36.447583, 26.193895, 15.527791,…
    ## $ `2010`           <dbl> 15.545214, 5.733854, 36.849648, 27.400110, 14.462760,…
    ## $ `2011`           <dbl> 16.028677, 5.957514, 37.180314, 28.914348, 16.100904,…
    ## $ `2012`           <dbl> 16.4474987, 6.2242756, 37.5407488, 31.6669279, 19.375…
    ## $ `2013`           <dbl> 16.914625, 6.473301, 37.870347, 31.695183, 18.672306,…
    ## $ `2014`           <dbl> 17.392349, 6.720331, 38.184152, 31.859257, 17.623956,…
    ## $ `2015`           <dbl> 17.892005, 7.015917, 38.543180, 33.903515, 16.516633,…
    ## $ `2016`           <dbl> 18.359993, 7.281390, 38.801719, 38.851444, 24.594474,…
    ## $ `2017`           <dbl> 18.7951512, 7.5136731, 39.0390136, 40.1973319, 25.389…
    ## $ `2018`           <dbl> 19.2951759, 7.8095655, 39.3231864, 43.0283322, 27.041…
    ## $ `2019`           <dbl> 19.7881558, 8.0758886, 39.6438476, 44.3897728, 29.138…
    ## $ `2020`           <dbl> 20.2795988, 8.3660097, 39.8948302, 46.2686206, 30.998…
    ## $ `2021`           <dbl> 20.773627, 8.684137, 40.213891, 48.103609, 32.772690,…
    ## $ `2022`           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ ...68            <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…

We can also see that the `wdi` dataset has many NA values, so it
probably has a lot of completely empty columns and/or rows. We will
remove them from both datasets and check how many rows/cols are left:

``` r
# Function to clean dataset
clean_dataset <- function(df) {
  df %>%
    select(where(~!all(is.na(.)))) %>%  # Remove empty columns
    filter(if_all(everything(), ~!is.na(.)))  # Remove empty rows
}

# Function to create comparison table as a formatted data frame
create_comparison_table <- function(datasets) {
  comparison_data <- lapply(names(datasets), function(name) {
    ds <- datasets[[name]]
    data.frame(
      dataset = name,
      rows_before = nrow(ds$original),
      rows_after = nrow(ds$cleaned),
      cols_before = ncol(ds$original),
      cols_after = ncol(ds$cleaned),
      rows_retained = round((nrow(ds$cleaned) / nrow(ds$original)) * 100, 2),
      cols_retained = round((ncol(ds$cleaned) / ncol(ds$original)) * 100, 2)
    )
  })
  
  do.call(rbind, comparison_data)
}

# Clean datasets
cs_rates_cleaned <- clean_dataset(cs_section_rates_raw)
wdi_cleaned <- clean_dataset(world_develop_indic_raw)

# Create list of datasets
datasets <- list(
  "CS rates" = list(original = cs_section_rates_raw, cleaned = cs_rates_cleaned),
  "WDI" = list(original = world_develop_indic_raw, cleaned = wdi_cleaned)
)

# Generate and print the comparison table
comparison_table <- create_comparison_table(datasets)

# formatting output table
gt(comparison_table) %>%
  fmt_number(columns = c("rows_retained", "cols_retained"), decimals = 2) %>%
  tab_style(
    style = cell_borders(sides = "all", color = "black", weight = px(1)),
    locations = cells_body()
  ) %>%
  tab_options(
    column_labels.background.color = "lightgray",
    table.border.top.width = px(3),
    table.border.top.color = "black",
    table.border.bottom.color = "black",
    table.border.bottom.width = px(3),
    column_labels.border.top.width = px(3),
    column_labels.border.top.color = "black",
    column_labels.border.bottom.width = px(3),
    column_labels.border.bottom.color = "black"
  )
```

<div id="qdtdmkxaux" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qdtdmkxaux table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
&#10;#qdtdmkxaux thead, #qdtdmkxaux tbody, #qdtdmkxaux tfoot, #qdtdmkxaux tr, #qdtdmkxaux td, #qdtdmkxaux th {
  border-style: none;
}
&#10;#qdtdmkxaux p {
  margin: 0;
  padding: 0;
}
&#10;#qdtdmkxaux .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #000000;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 3px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}
&#10;#qdtdmkxaux .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}
&#10;#qdtdmkxaux .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}
&#10;#qdtdmkxaux .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}
&#10;#qdtdmkxaux .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}
&#10;#qdtdmkxaux .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}
&#10;#qdtdmkxaux .gt_col_headings {
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 3px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}
&#10;#qdtdmkxaux .gt_col_heading {
  color: #333333;
  background-color: #D3D3D3;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}
&#10;#qdtdmkxaux .gt_column_spanner_outer {
  color: #333333;
  background-color: #D3D3D3;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}
&#10;#qdtdmkxaux .gt_column_spanner_outer:first-child {
  padding-left: 0;
}
&#10;#qdtdmkxaux .gt_column_spanner_outer:last-child {
  padding-right: 0;
}
&#10;#qdtdmkxaux .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 3px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}
&#10;#qdtdmkxaux .gt_spanner_row {
  border-bottom-style: hidden;
}
&#10;#qdtdmkxaux .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}
&#10;#qdtdmkxaux .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}
&#10;#qdtdmkxaux .gt_from_md > :first-child {
  margin-top: 0;
}
&#10;#qdtdmkxaux .gt_from_md > :last-child {
  margin-bottom: 0;
}
&#10;#qdtdmkxaux .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}
&#10;#qdtdmkxaux .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#qdtdmkxaux .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}
&#10;#qdtdmkxaux .gt_row_group_first td {
  border-top-width: 2px;
}
&#10;#qdtdmkxaux .gt_row_group_first th {
  border-top-width: 2px;
}
&#10;#qdtdmkxaux .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#qdtdmkxaux .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}
&#10;#qdtdmkxaux .gt_first_summary_row.thick {
  border-top-width: 2px;
}
&#10;#qdtdmkxaux .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}
&#10;#qdtdmkxaux .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#qdtdmkxaux .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}
&#10;#qdtdmkxaux .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}
&#10;#qdtdmkxaux .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}
&#10;#qdtdmkxaux .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}
&#10;#qdtdmkxaux .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}
&#10;#qdtdmkxaux .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#qdtdmkxaux .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}
&#10;#qdtdmkxaux .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#qdtdmkxaux .gt_left {
  text-align: left;
}
&#10;#qdtdmkxaux .gt_center {
  text-align: center;
}
&#10;#qdtdmkxaux .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}
&#10;#qdtdmkxaux .gt_font_normal {
  font-weight: normal;
}
&#10;#qdtdmkxaux .gt_font_bold {
  font-weight: bold;
}
&#10;#qdtdmkxaux .gt_font_italic {
  font-style: italic;
}
&#10;#qdtdmkxaux .gt_super {
  font-size: 65%;
}
&#10;#qdtdmkxaux .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}
&#10;#qdtdmkxaux .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}
&#10;#qdtdmkxaux .gt_indent_1 {
  text-indent: 5px;
}
&#10;#qdtdmkxaux .gt_indent_2 {
  text-indent: 10px;
}
&#10;#qdtdmkxaux .gt_indent_3 {
  text-indent: 15px;
}
&#10;#qdtdmkxaux .gt_indent_4 {
  text-indent: 20px;
}
&#10;#qdtdmkxaux .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    &#10;    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="dataset">dataset</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rows_before">rows_before</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rows_after">rows_after</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cols_before">cols_before</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cols_after">cols_after</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rows_retained">rows_retained</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cols_retained">cols_retained</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="dataset" class="gt_row gt_left" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-right-width: 1px; border-right-style: solid; border-right-color: black; border-top-width: 1px; border-top-style: solid; border-top-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">CS rates</td>
<td headers="rows_before" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-right-width: 1px; border-right-style: solid; border-right-color: black; border-top-width: 1px; border-top-style: solid; border-top-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">2024</td>
<td headers="rows_after" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-right-width: 1px; border-right-style: solid; border-right-color: black; border-top-width: 1px; border-top-style: solid; border-top-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">2023</td>
<td headers="cols_before" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-right-width: 1px; border-right-style: solid; border-right-color: black; border-top-width: 1px; border-top-style: solid; border-top-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">5</td>
<td headers="cols_after" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-right-width: 1px; border-right-style: solid; border-right-color: black; border-top-width: 1px; border-top-style: solid; border-top-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">5</td>
<td headers="rows_retained" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-right-width: 1px; border-right-style: solid; border-right-color: black; border-top-width: 1px; border-top-style: solid; border-top-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">99.95</td>
<td headers="cols_retained" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-right-width: 1px; border-right-style: solid; border-right-color: black; border-top-width: 1px; border-top-style: solid; border-top-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">100.00</td></tr>
    <tr><td headers="dataset" class="gt_row gt_left" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-right-width: 1px; border-right-style: solid; border-right-color: black; border-top-width: 1px; border-top-style: solid; border-top-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">WDI</td>
<td headers="rows_before" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-right-width: 1px; border-right-style: solid; border-right-color: black; border-top-width: 1px; border-top-style: solid; border-top-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">395276</td>
<td headers="rows_after" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-right-width: 1px; border-right-style: solid; border-right-color: black; border-top-width: 1px; border-top-style: solid; border-top-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">24357</td>
<td headers="cols_before" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-right-width: 1px; border-right-style: solid; border-right-color: black; border-top-width: 1px; border-top-style: solid; border-top-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">68</td>
<td headers="cols_after" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-right-width: 1px; border-right-style: solid; border-right-color: black; border-top-width: 1px; border-top-style: solid; border-top-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">67</td>
<td headers="rows_retained" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-right-width: 1px; border-right-style: solid; border-right-color: black; border-top-width: 1px; border-top-style: solid; border-top-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">6.16</td>
<td headers="cols_retained" class="gt_row gt_right" style="border-left-width: 1px; border-left-style: solid; border-left-color: black; border-right-width: 1px; border-right-style: solid; border-right-color: black; border-top-width: 1px; border-top-style: solid; border-top-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black;">98.53</td></tr>
  </tbody>
  &#10;  
</table>
</div>

``` r
rm(datasets)
```

As we can see, the cs section rates data set had only one line removed,
the one which showed up in the parsing error. In comparison, the `wdi`
set changed a lot, as it had more than 100,000 empty rows which where
successfully removed. Only one column was removed. We will later check
the number of NAs remaining in the non empty columns/rows.

Now we’ll rename the columns so they are easier to work with in the
code:

``` r
wdi <- wdi_cleaned %>%
  dplyr::rename(country = 1,
         country_code = 2, 
         indicator_name = 3,
         indicator_code = 4)

cs_rates <- cs_rates_cleaned %>%
  dplyr::rename(country_code = 1,
         country = 2,
         coverage_start_year = 3,
         coverage_end_year = 4,
         cs_section_rate = 5)

# reorder the columns
cs_rates <- cs_rates %>% relocate(country, .before = country_code)
```

Let’s check if our changes occurred successfully:

``` r
glimpse(cs_rates)
```

    ## Rows: 2,023
    ## Columns: 5
    ## $ country             <chr> "Afghanistan", "Afghanistan", "Afghanistan", "Afgh…
    ## $ country_code        <chr> "AFG", "AFG", "AFG", "AFG", "ALB", "ALB", "ALB", "…
    ## $ coverage_start_year <int> 2005, 2008, 2010, 2016, 1992, 1993, 1994, 1995, 19…
    ## $ coverage_end_year   <int> 2010, 2011, 2015, 2018, 1992, 1993, 1994, 1995, 19…
    ## $ cs_section_rate     <dbl> 5.0, 3.6, 2.7, 6.6, 9.3, 9.8, 7.8, 8.4, 8.6, 10.0,…

``` r
glimpse(wdi)
```

    ## Rows: 24,357
    ## Columns: 67
    ## $ country        <chr> "Africa Eastern and Southern", "Africa Eastern and Sout…
    ## $ country_code   <chr> "AFE", "AFE", "AFE", "AFE", "AFE", "AFE", "AFE", "AFE",…
    ## $ indicator_name <chr> "Age dependency ratio (% of working-age population)", "…
    ## $ indicator_code <chr> "SP.POP.DPND", "SP.POP.DPND.OL", "SP.POP.DPND.YG", "BM.…
    ## $ `1960`         <dbl> 89.5946042, 5.6269436, 83.6687052, 5599997.7622409, 802…
    ## $ `1961`         <dbl> 89.873370, 5.598776, 83.936992, 5599997.762241, 802701.…
    ## $ `1962`         <dbl> 90.1917207, 5.5717185, 84.2439941, 8399996.6433613, 802…
    ## $ `1963`         <dbl> 90.5746781, 5.5497017, 84.6131401, 15399993.8461625, 80…
    ## $ `1964`         <dbl> 90.9527190, 5.5342357, 84.9945123, 15399993.8461625, 80…
    ## $ `1965`         <dbl> 91.3468207, 5.5263477, 85.3985091, 26599989.3706442, 10…
    ## $ `1966`         <dbl> 91.7855001, 5.5254460, 85.8336878, 26599989.3706442, 10…
    ## $ `1967`         <dbl> 92.2119694, 5.5316322, 86.2517743, 32199987.1328851, 10…
    ## $ `1968`         <dbl> 92.6173995, 5.5437746, 86.6472132, 37799984.8951260, 10…
    ## $ `1969`         <dbl> 93.0188868, 5.5584769, 87.0384893, 39199984.3356862, 10…
    ## $ `1970`         <dbl> 93.4629660, 5.5756951, 87.4691258, 46199981.5384874, 12…
    ## $ `1971`         <dbl> 93.9225490, 5.5964249, 87.9048856, 47527375.6763246, 12…
    ## $ `1972`         <dbl> 94.3642444, 5.6173666, 88.3168559, 63773980.2137103, 12…
    ## $ `1973`         <dbl> 94.6906945, 5.6358203, 88.6126209, 78078851.9005019, 12…
    ## $ `1974`         <dbl> 94.8487166, 5.6486931, 88.7450932, 72148373.0902195, 12…
    ## $ `1975`         <dbl> 94.9673744, 5.6580336, 88.8406821, 107043108.0380230, 1…
    ## $ `1976`         <dbl> 95.1485687, 5.6724073, 88.9937682, 111424412.8323970, 1…
    ## $ `1977`         <dbl> 95.276895, 5.686525, 89.088311, 147872278.821728, 18008…
    ## $ `1978`         <dbl> 95.2705420, 5.6994154, 89.0329039, 181309089.7682300, 1…
    ## $ `1979`         <dbl> 95.2767184, 5.7162170, 88.9804601, 177728123.5716670, 2…
    ## $ `1980`         <dbl> 95.190407, 5.719248, 88.882973, 220288726.280588, 22083…
    ## $ `1981`         <dbl> 95.125777, 5.717114, 88.832212, 234429968.226397, 24023…
    ## $ `1982`         <dbl> 95.134398, 5.719387, 88.850052, 212926712.018452, 26023…
    ## $ `1983`         <dbl> 95.006717, 5.707685, 88.738449, 220912474.528507, 27759…
    ## $ `1984`         <dbl> 94.771360, 5.689743, 88.516794, 173752336.219322, 28978…
    ## $ `1985`         <dbl> 94.548269, 5.678466, 88.297263, 126039179.160406, 30908…
    ## $ `1986`         <dbl> 94.391103, 5.667027, 88.142303, 134591645.837634, 33761…
    ## $ `1987`         <dbl> 94.380672, 5.665872, 88.128994, 189284510.541473, 35683…
    ## $ `1988`         <dbl> 94.479295, 5.660053, 88.236488, 179288967.013878, 38170…
    ## $ `1989`         <dbl> 94.547037, 5.643018, 88.334999, 162062975.153806, 40929…
    ## $ `1990`         <dbl> 94.580170, 5.632531, 88.403091, 167274402.486613, 43850…
    ## $ `1991`         <dbl> 94.612593, 5.630006, 88.474471, 209382301.388228, 45879…
    ## $ `1992`         <dbl> 94.668838, 5.631488, 88.570916, 180139306.880349, 46516…
    ## $ `1993`         <dbl> 94.786017, 5.627153, 88.695881, 260238512.710708, 48495…
    ## $ `1994`         <dbl> 94.483484, 5.601098, 88.406333, 236955019.516439, 51106…
    ## $ `1995`         <dbl> 94.007709, 5.567320, 87.952566, 393810107.268975, 54564…
    ## $ `1996`         <dbl> 93.889806, 5.552167, 87.825822, 383757638.537913, 58542…
    ## $ `1997`         <dbl> 93.727470, 5.537749, 87.623896, 386585738.585637, 63969…
    ## $ `1998`         <dbl> 93.268337, 5.510807, 87.118459, 343401984.913520, 70258…
    ## $ `1999`         <dbl> 92.653965, 5.482828, 86.452163, 329550880.441077, 76599…
    ## $ `2000`         <dbl> 92.044732, 5.462842, 85.768931, 396369882.141538, 74081…
    ## $ `2001`         <dbl> 91.402455, 5.445348, 85.047934, 458714373.790437, 75972…
    ## $ `2002`         <dbl> 90.771396, 5.427740, 84.342583, 587668403.787097, 79733…
    ## $ `2003`         <dbl> 90.188457, 5.409492, 83.693345, 762155199.057510, 84114…
    ## $ `2004`         <dbl> 89.648105, 5.393492, 83.097151, 1066498399.690930, 8604…
    ## $ `2005`         <dbl> 89.176045, 5.383261, 82.581709, 1260750199.582890, 8355…
    ## $ `2006`         <dbl> 88.748358, 5.375328, 82.123852, 1460852924.740550, 8492…
    ## $ `2007`         <dbl> 88.345801, 5.368210, 81.705422, 1836130528.419840, 8795…
    ## $ `2008`         <dbl> 87.974597, 5.362260, 81.338145, 1913592059.928240, 9005…
    ## $ `2009`         <dbl> 87.619597, 5.363427, 80.990470, 1912270943.608640, 9448…
    ## $ `2010`         <dbl> 87.238455, 5.378027, 80.609205, 2068158357.135980, 9456…
    ## $ `2011`         <dbl> 86.823065, 5.404897, 80.192475, 2218812932.794660, 9210…
    ## $ `2012`         <dbl> 86.407767, 5.438799, 79.777847, 2366000693.418560, 8944…
    ## $ `2013`         <dbl> 85.976176, 5.473612, 79.352779, 2379213510.251230, 7647…
    ## $ `2014`         <dbl> 85.499375, 5.509918, 78.874913, 2368730261.332780, 7586…
    ## $ `2015`         <dbl> 84.957551, 5.544147, 78.311969, 2256460184.697380, 7689…
    ## $ `2016`         <dbl> 84.439468, 5.584600, 77.798386, 2394607870.654370, 8320…
    ## $ `2017`         <dbl> 83.930980, 5.631777, 77.297024, 2552763140.717230, 8226…
    ## $ `2018`         <dbl> 83.342388, 5.677017, 76.690679, 2161661760.558540, 5362…
    ## $ `2019`         <dbl> 82.6920587, 5.7184242, 76.0285640, 1787646004.5088401, …
    ## $ `2020`         <dbl> 81.9689633, 5.7331105, 75.3108616, 1695216299.9684601, …
    ## $ `2021`         <dbl> 81.1899885, 5.7061994, 74.5651490, 1895853917.3613501, …
    ## $ `2022`         <dbl> 80.3853443, 5.6623527, 73.7999900, 1912708774.6885400, …

It seems like all the columns full of NAs have been removed from de
`wdi` dataset, and also the column names have been successfully changed
and reordered. We will now remove any duplicate rows from both datasets:

``` r
# adding an id for each row
cs_rates_id <- cs_rates %>%
  dplyr::mutate(row_id = row_number())

cs_removed_dupes <- cs_rates_id %>%
  distinct() %>%
  anti_join(cs_rates_id, by = "row_id")
print(cs_removed_dupes)
```

    ## # A tibble: 0 × 6
    ## # ℹ 6 variables: country <chr>, country_code <chr>, coverage_start_year <int>,
    ## #   coverage_end_year <int>, cs_section_rate <dbl>, row_id <int>

``` r
# adding an id for each row
wdi_id <- wdi %>%
  dplyr::mutate(row_id = row_number())

wdi_removed_dupes <- wdi_id %>%
  distinct() %>%
  anti_join(wdi_id, by = "row_id")
print(wdi_removed_dupes)
```

    ## # A tibble: 0 × 68
    ## # ℹ 68 variables: country <chr>, country_code <chr>, indicator_name <chr>,
    ## #   indicator_code <chr>, 1960 <dbl>, 1961 <dbl>, 1962 <dbl>, 1963 <dbl>,
    ## #   1964 <dbl>, 1965 <dbl>, 1966 <dbl>, 1967 <dbl>, 1968 <dbl>, 1969 <dbl>,
    ## #   1970 <dbl>, 1971 <dbl>, 1972 <dbl>, 1973 <dbl>, 1974 <dbl>, 1975 <dbl>,
    ## #   1976 <dbl>, 1977 <dbl>, 1978 <dbl>, 1979 <dbl>, 1980 <dbl>, 1981 <dbl>,
    ## #   1982 <dbl>, 1983 <dbl>, 1984 <dbl>, 1985 <dbl>, 1986 <dbl>, 1987 <dbl>,
    ## #   1988 <dbl>, 1989 <dbl>, 1990 <dbl>, 1991 <dbl>, 1992 <dbl>, 1993 <dbl>, …

``` r
rm(cs_rates_id, cs_removed_dupes, wdi_id, wdi_removed_dupes)
gc()
```

    ##            used  (Mb) gc trigger  (Mb) limit (Mb) max used  (Mb)
    ## Ncells  2682922 143.3    5162045 275.7         NA  3581235 191.3
    ## Vcells 32995671 251.8   55794222 425.7      16384 46428053 354.3

Apparently everything is in order. The `removed_dupes` dataframes have 0
lines, meaning that there weren’t any duplicated rows to remove. Let’s
do one final check to see how much data is missing from the `wdi`
dataset, which is the bigger and most problematic of our datasets.

``` r
# missing percentage per column
sapply(wdi, function(x) sum(is.na(x)) / length(x) * 100)
```

    ##        country   country_code indicator_name indicator_code           1960 
    ##              0              0              0              0              0 
    ##           1961           1962           1963           1964           1965 
    ##              0              0              0              0              0 
    ##           1966           1967           1968           1969           1970 
    ##              0              0              0              0              0 
    ##           1971           1972           1973           1974           1975 
    ##              0              0              0              0              0 
    ##           1976           1977           1978           1979           1980 
    ##              0              0              0              0              0 
    ##           1981           1982           1983           1984           1985 
    ##              0              0              0              0              0 
    ##           1986           1987           1988           1989           1990 
    ##              0              0              0              0              0 
    ##           1991           1992           1993           1994           1995 
    ##              0              0              0              0              0 
    ##           1996           1997           1998           1999           2000 
    ##              0              0              0              0              0 
    ##           2001           2002           2003           2004           2005 
    ##              0              0              0              0              0 
    ##           2006           2007           2008           2009           2010 
    ##              0              0              0              0              0 
    ##           2011           2012           2013           2014           2015 
    ##              0              0              0              0              0 
    ##           2016           2017           2018           2019           2020 
    ##              0              0              0              0              0 
    ##           2021           2022 
    ##              0              0

``` r
# value counts to check if there aren't any empty values aside from NA
# Check for empty strings or other potential "missing" values
empty_check <- sapply(wdi, function(x) sum(x == "" | x == " ") / length(x) * 100)
print("Percentage of empty strings in original dataset:")
```

    ## [1] "Percentage of empty strings in original dataset:"

``` r
print(empty_check)
```

    ##        country   country_code indicator_name indicator_code           1960 
    ##              0              0              0              0              0 
    ##           1961           1962           1963           1964           1965 
    ##              0              0              0              0              0 
    ##           1966           1967           1968           1969           1970 
    ##              0              0              0              0              0 
    ##           1971           1972           1973           1974           1975 
    ##              0              0              0              0              0 
    ##           1976           1977           1978           1979           1980 
    ##              0              0              0              0              0 
    ##           1981           1982           1983           1984           1985 
    ##              0              0              0              0              0 
    ##           1986           1987           1988           1989           1990 
    ##              0              0              0              0              0 
    ##           1991           1992           1993           1994           1995 
    ##              0              0              0              0              0 
    ##           1996           1997           1998           1999           2000 
    ##              0              0              0              0              0 
    ##           2001           2002           2003           2004           2005 
    ##              0              0              0              0              0 
    ##           2006           2007           2008           2009           2010 
    ##              0              0              0              0              0 
    ##           2011           2012           2013           2014           2015 
    ##              0              0              0              0              0 
    ##           2016           2017           2018           2019           2020 
    ##              0              0              0              0              0 
    ##           2021           2022 
    ##              0              0

It seems like we removed all of the rows which had missing values. Most
likely the empty rows represented the countries which have more problems
with gathering/communicating data. Depending on future results, we can
come back to this and understand which countries are missing and if it’s
possible to impute some data.

Another thing we must pay attention to is the year range that will be
included in the final input dataset of the model. Considering the target
variable as `cs_section_rate` from the `cs_rates` dataset, its year
coverage will determine which years of the `wdi` dataset will be
filtered:

``` r
# checking range of years included in cs_rates
cs_min_year <- min(cs_rates$coverage_start_year)
cs_max_year <- max(cs_rates$coverage_end_year)
cat("The range of years is between", cs_min_year, "and", cs_max_year)
```

    ## The range of years is between 1985 and 2019

This means that we can filter out all columns that are not contemplated
in this range from the `wdi` dataset, seeing as anything outside this
range won’t be possible to merge with the `cs_rates` dataset:

``` r
years_to_keep <- as.character(cs_min_year:cs_max_year)

# selects columns that are not named w/4 digits OR if it's in years_to_keep vector
wdi <- wdi %>%
 select(!matches("^\\d{4}$") | all_of(years_to_keep))

glimpse(wdi)
```

    ## Rows: 24,357
    ## Columns: 39
    ## $ country        <chr> "Africa Eastern and Southern", "Africa Eastern and Sout…
    ## $ country_code   <chr> "AFE", "AFE", "AFE", "AFE", "AFE", "AFE", "AFE", "AFE",…
    ## $ indicator_name <chr> "Age dependency ratio (% of working-age population)", "…
    ## $ indicator_code <chr> "SP.POP.DPND", "SP.POP.DPND.OL", "SP.POP.DPND.YG", "BM.…
    ## $ `1985`         <dbl> 94.548269, 5.678466, 88.297263, 126039179.160406, 30908…
    ## $ `1986`         <dbl> 94.391103, 5.667027, 88.142303, 134591645.837634, 33761…
    ## $ `1987`         <dbl> 94.380672, 5.665872, 88.128994, 189284510.541473, 35683…
    ## $ `1988`         <dbl> 94.479295, 5.660053, 88.236488, 179288967.013878, 38170…
    ## $ `1989`         <dbl> 94.547037, 5.643018, 88.334999, 162062975.153806, 40929…
    ## $ `1990`         <dbl> 94.580170, 5.632531, 88.403091, 167274402.486613, 43850…
    ## $ `1991`         <dbl> 94.612593, 5.630006, 88.474471, 209382301.388228, 45879…
    ## $ `1992`         <dbl> 94.668838, 5.631488, 88.570916, 180139306.880349, 46516…
    ## $ `1993`         <dbl> 94.786017, 5.627153, 88.695881, 260238512.710708, 48495…
    ## $ `1994`         <dbl> 94.483484, 5.601098, 88.406333, 236955019.516439, 51106…
    ## $ `1995`         <dbl> 94.007709, 5.567320, 87.952566, 393810107.268975, 54564…
    ## $ `1996`         <dbl> 93.889806, 5.552167, 87.825822, 383757638.537913, 58542…
    ## $ `1997`         <dbl> 93.727470, 5.537749, 87.623896, 386585738.585637, 63969…
    ## $ `1998`         <dbl> 93.268337, 5.510807, 87.118459, 343401984.913520, 70258…
    ## $ `1999`         <dbl> 92.653965, 5.482828, 86.452163, 329550880.441077, 76599…
    ## $ `2000`         <dbl> 92.044732, 5.462842, 85.768931, 396369882.141538, 74081…
    ## $ `2001`         <dbl> 91.402455, 5.445348, 85.047934, 458714373.790437, 75972…
    ## $ `2002`         <dbl> 90.771396, 5.427740, 84.342583, 587668403.787097, 79733…
    ## $ `2003`         <dbl> 90.188457, 5.409492, 83.693345, 762155199.057510, 84114…
    ## $ `2004`         <dbl> 89.648105, 5.393492, 83.097151, 1066498399.690930, 8604…
    ## $ `2005`         <dbl> 89.176045, 5.383261, 82.581709, 1260750199.582890, 8355…
    ## $ `2006`         <dbl> 88.748358, 5.375328, 82.123852, 1460852924.740550, 8492…
    ## $ `2007`         <dbl> 88.345801, 5.368210, 81.705422, 1836130528.419840, 8795…
    ## $ `2008`         <dbl> 87.974597, 5.362260, 81.338145, 1913592059.928240, 9005…
    ## $ `2009`         <dbl> 87.619597, 5.363427, 80.990470, 1912270943.608640, 9448…
    ## $ `2010`         <dbl> 87.238455, 5.378027, 80.609205, 2068158357.135980, 9456…
    ## $ `2011`         <dbl> 86.823065, 5.404897, 80.192475, 2218812932.794660, 9210…
    ## $ `2012`         <dbl> 86.407767, 5.438799, 79.777847, 2366000693.418560, 8944…
    ## $ `2013`         <dbl> 85.976176, 5.473612, 79.352779, 2379213510.251230, 7647…
    ## $ `2014`         <dbl> 85.499375, 5.509918, 78.874913, 2368730261.332780, 7586…
    ## $ `2015`         <dbl> 84.957551, 5.544147, 78.311969, 2256460184.697380, 7689…
    ## $ `2016`         <dbl> 84.439468, 5.584600, 77.798386, 2394607870.654370, 8320…
    ## $ `2017`         <dbl> 83.930980, 5.631777, 77.297024, 2552763140.717230, 8226…
    ## $ `2018`         <dbl> 83.342388, 5.677017, 76.690679, 2161661760.558540, 5362…
    ## $ `2019`         <dbl> 82.6920587, 5.7184242, 76.0285640, 1787646004.5088401, …

Now, we will begin filtering the datasets so we can merge them together
without inconsistencies. First, we need to check country names and
country codes, which are our most important identifiers. Since both
datasets are from different sources, we need to make them compatible:

``` r
# typo found in one of the country codes in WHO data (VEM instead of VEN, representing Venezuela), correction
cs_rates <- cs_rates %>%
  mutate(country_code = if_else(country_code == "VEM", "VEN", country_code))

# countries in (Betran, 2018) WHO study (cs_rates) to filter WDI dataset, which has a much larger coverage of countries
countries_who <- cs_rates %>%
  select(country_code, country) %>%
  distinct()

# filter using country codes from cs_rates
wdi_who <- wdi %>%
  filter(country_code %in% countries_who$country_code)

# checking which countries in cs_rates are available in wdi
wdi_filt_cs <- wdi_who %>%
  select(country_code, country) %>%
  distinct()

# left join to find differences between dfs
combined_wdi <- countries_who %>%
  left_join(wdi_filt_cs, by = "country_code", suffix = c("_who", "_wdi"))

#datatable(combined_wdi, 
#          options = list(pageLength = 10, 
#                         scrollX = TRUE, 
#                         scrollY = "300px"))
print(combined_wdi)
```

    ## # A tibble: 182 × 3
    ##    country_code country_who country_wdi
    ##    <chr>        <chr>       <chr>      
    ##  1 AFG          Afghanistan Afghanistan
    ##  2 ALB          Albania     Albania    
    ##  3 DZA          Algeria     Algeria    
    ##  4 AND          Andorra     Andorra    
    ##  5 AGO          Angola      Angola     
    ##  6 ARG          Argentina   Argentina  
    ##  7 ARM          Armenia     Armenia    
    ##  8 AUS          Australia   Australia  
    ##  9 AUT          Austria     Austria    
    ## 10 AZE          Azerbaijan  Azerbaijan 
    ## # ℹ 172 more rows

The table above represents all the countries that will be contemplated
by the analysis, which are the ones with matching country codes in both
datasets. Considering that one error was already found in a country code
in the `cs_rates` dataset, each country code was checked
manually/visually, using an open database online. No other errors were
found, only slight differences in country names. Regarding the multiple
`country` values for the GBR `country_code`, all GBR entries will be
removed from analysis for now:

``` r
# removing observations from GBR
wdi_who_mgb <- wdi_who %>%
  filter(country_code != "GBR")
```

Let’s check the current state of our datasets:

``` r
glimpse(cs_rates)
```

    ## Rows: 2,023
    ## Columns: 5
    ## $ country             <chr> "Afghanistan", "Afghanistan", "Afghanistan", "Afgh…
    ## $ country_code        <chr> "AFG", "AFG", "AFG", "AFG", "ALB", "ALB", "ALB", "…
    ## $ coverage_start_year <int> 2005, 2008, 2010, 2016, 1992, 1993, 1994, 1995, 19…
    ## $ coverage_end_year   <int> 2010, 2011, 2015, 2018, 1992, 1993, 1994, 1995, 19…
    ## $ cs_section_rate     <dbl> 5.0, 3.6, 2.7, 6.6, 9.3, 9.8, 7.8, 8.4, 8.6, 10.0,…

``` r
glimpse(wdi_who_mgb)
```

    ## Rows: 17,536
    ## Columns: 39
    ## $ country        <chr> "Afghanistan", "Afghanistan", "Afghanistan", "Afghanist…
    ## $ country_code   <chr> "AFG", "AFG", "AFG", "AFG", "AFG", "AFG", "AFG", "AFG",…
    ## $ indicator_name <chr> "Age dependency ratio (% of working-age population)", "…
    ## $ indicator_code <chr> "SP.POP.DPND", "SP.POP.DPND.OL", "SP.POP.DPND.YG", "TX.…
    ## $ `1985`         <dbl> 96.654714, 4.576092, 92.078622, 567000000.000000, 11940…
    ## $ `1986`         <dbl> 97.077499, 4.508391, 92.569108, 552000000.000000, 14040…
    ## $ `1987`         <dbl> 97.491929, 4.473853, 93.018076, 512000000.000000, 99600…
    ## $ `1988`         <dbl> 97.916017, 4.457402, 93.458616, 395000000.000000, 90000…
    ## $ `1989`         <dbl> 98.360693, 4.462200, 93.898493, 236000000.000000, 82200…
    ## $ `1990`         <dbl> 98.890488, 4.468231, 94.422257, 235000000.000000, 93600…
    ## $ `1991`         <dbl> 99.557007, 4.482376, 95.074631, 189000000.000000, 44300…
    ## $ `1992`         <dbl> 100.302195, 4.514653, 95.787542, 181000000.000000, 3980…
    ## $ `1993`         <dbl> 101.072116, 4.554425, 96.517691, 688000000.000000, 4650…
    ## $ `1994`         <dbl> 101.988301, 4.593354, 97.394948, 105000000.000000, 3910…
    ## $ `1995`         <dbl> 103.028465, 4.628651, 98.399815, 166000000.000000, 3870…
    ## $ `1996`         <dbl> 104.143896, 4.663248, 99.480648, 128000000.000000, 6610…
    ## $ `1997`         <dbl> 105.288663, 4.693864, 100.594800, 144000000.000000, 604…
    ## $ `1998`         <dbl> 106.419013, 4.718493, 101.700520, 159000000.000000, 462…
    ## $ `1999`         <dbl> 107.472472, 4.741467, 102.731005, 166000000.000000, 101…
    ## $ `2000`         <dbl> 108.346635, 4.760314, 103.586320, 137000000.000000, 117…
    ## $ `2001`         <dbl> 108.989886, 4.775098, 104.214788, 68000000.000000, 1696…
    ## $ `2002`         <dbl> 109.347157, 4.791609, 104.555548, 100000000.000000, 245…
    ## $ `2003`         <dbl> 109.447532, 4.804548, 104.642984, 144000000.000000, 210…
    ## $ `2004`         <dbl> 109.286820, 4.806580, 104.480240, 305000000.000000, 217…
    ## $ `2005`         <dbl> 107.964605, 4.781964, 103.182640, 384000000.000000, 247…
    ## $ `2006`         <dbl> 106.326191, 4.750411, 101.575780, 416000000.000000, 274…
    ## $ `2007`         <dbl> 108.338125, 4.803681, 103.534444, 454000000.000000, 302…
    ## $ `2008`         <dbl> 109.240379, 4.849388, 104.390990, 540000000.000000, 302…
    ## $ `2009`         <dbl> 106.845774, 4.830454, 102.015321, 403000000.000000, 333…
    ## $ `2010`         <dbl> 105.433416, 4.834730, 100.598686, 388000000.000000, 515…
    ## $ `2011`         <dbl> 102.585972, 4.809149, 97.776823, 376000000.000000, 6515…
    ## $ `2012`         <dbl> 99.300360, 4.767237, 94.533123, 429000000.000000, 90690…
    ## $ `2013`         <dbl> 97.125534, 4.737487, 92.388046, 515000000.000000, 85540…
    ## $ `2014`         <dbl> 94.706697, 4.690797, 90.015900, 570000000.000000, 77290…
    ## $ `2015`         <dbl> 93.042448, 4.644246, 88.398202, 571000000.000000, 77230…
    ## $ `2016`         <dbl> 92.012125, 4.606351, 87.405774, 596000000.000000, 65340…
    ## $ `2017`         <dbl> 90.543094, 4.572687, 85.970407, 723000000.000000, 70650…
    ## $ `2018`         <dbl> 89.091451, 4.551607, 84.539844, 875000000.000000, 74070…
    ## $ `2019`         <dbl> 87.649322, 4.536901, 83.112421, 864000000.000000, 67770…

``` r
summary(cs_rates)
```

    ##    country          country_code       coverage_start_year coverage_end_year
    ##  Length:2023        Length:2023        Min.   :1985        Min.   :1990     
    ##  Class :character   Class :character   1st Qu.:1998        1st Qu.:1999     
    ##  Mode  :character   Mode  :character   Median :2005        Median :2006     
    ##                                        Mean   :2004        Mean   :2005     
    ##                                        3rd Qu.:2011        3rd Qu.:2012     
    ##                                        Max.   :2018        Max.   :2019     
    ##  cs_section_rate
    ##  Min.   : 0.30  
    ##  1st Qu.:10.25  
    ##  Median :17.80  
    ##  Mean   :18.97  
    ##  3rd Qu.:26.20  
    ##  Max.   :58.10

Observing the `wdi` dataset, we can see that we have each line
representing a unique combination of `country` and indicator, and each
column (aside the identifier columns) represents a given year and the
respective value for each indicator in that year. This indicates a wide
format dataset, as the different measurements of the same variable
(indicator) are spread out across different columns (multiple
observations: years). We need to convert it to a long format, which
takes the `year` column names and converts them to values in a new
column `years`, so that it’s possible to merge with `cs_rates`, which is
also in long format (`year, cs_section_rate` columns). Our unit of
analysis becomes the combination of `country` and `year` in both
datasets.

## Pivoting and merging data

Our main objective in this analysis is to identify which World
Development Indicators (socioeconomic indicators) are associated with
the rise in caesarean section rates worldwide observed in the WHO study,
and use these indicators to predict caesarean section rates. Identifying
these indicators may help direct future studies and influence
policy-making. This means that our main variables of interest (features)
are the different indicators obtained from `wdi`. This means we need to
transform the data from the original wide to long, and then to another
type of wide, so that each indicator has its own column, but we still
leave the `country` and `year` columns long, for merging, as explained
previously.

``` r
# Convert to data.table for faster processing
setDT(wdi_who_mgb)

# Melt to long format
wdi_long <- melt(wdi_who_mgb, id.vars = c("country", "country_code", "indicator_code", "indicator_name"), 
                 variable.name = "year", value.name = "value")

# Convert year to integer
wdi_long[, year := as.integer(as.character(year))]

# If you need wide format for some analyses:
wdi_wide <- dcast(wdi_long, country + country_code + year ~ indicator_code, value.var = "value")

glimpse(wdi_long)
```

    ## Rows: 613,760
    ## Columns: 6
    ## $ country        <chr> "Afghanistan", "Afghanistan", "Afghanistan", "Afghanist…
    ## $ country_code   <chr> "AFG", "AFG", "AFG", "AFG", "AFG", "AFG", "AFG", "AFG",…
    ## $ indicator_code <chr> "SP.POP.DPND", "SP.POP.DPND.OL", "SP.POP.DPND.YG", "TX.…
    ## $ indicator_name <chr> "Age dependency ratio (% of working-age population)", "…
    ## $ year           <int> 1985, 1985, 1985, 1985, 1985, 1985, 1985, 1985, 1985, 1…
    ## $ value          <dbl> 96.654714, 4.576092, 92.078622, 567000000.000000, 11940…

``` r
glimpse(wdi_wide)
```

    ## Rows: 6,230
    ## Columns: 277
    ## $ country                   <chr> "Afghanistan", "Afghanistan", "Afghanistan",…
    ## $ country_code              <chr> "AFG", "AFG", "AFG", "AFG", "AFG", "AFG", "A…
    ## $ year                      <int> 1985, 1986, 1987, 1988, 1989, 1990, 1991, 19…
    ## $ BG.GSR.NFSV.GD.ZS         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BM.GSR.CMCP.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BM.GSR.FCTY.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BM.GSR.GNFS.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BM.GSR.INSF.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BM.GSR.MRCH.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BM.GSR.NFSV.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BM.GSR.ROYL.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BM.GSR.TOTL.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BM.GSR.TRAN.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BM.GSR.TRVL.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BM.TRF.PRVT.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BN.CAB.XOKA.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BN.CAB.XOKA.GD.ZS         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BN.FIN.TOTL.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BN.GSR.FCTY.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BN.GSR.GNFS.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BN.GSR.MRCH.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BN.KAC.EOMS.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BN.KLT.DINV.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BN.KLT.PTXL.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BN.RES.INCL.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BN.TRF.CURR.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BN.TRF.KOGT.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BX.GSR.CMCP.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BX.GSR.FCTY.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BX.GSR.GNFS.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BX.GSR.INSF.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BX.GSR.MRCH.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BX.GSR.NFSV.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BX.GSR.TOTL.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BX.GSR.TRAN.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BX.GSR.TRVL.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BX.PEF.TOTL.CD.WD         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ BX.TRF.CURR.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ EN.URB.LCTY               <dbl> 1239961, 1300299, 1358525, 1419444, 1482916,…
    ## $ EN.URB.LCTY.UR.ZS         <dbl> 62.09097, 63.34255, 64.78530, 65.10258, 65.8…
    ## $ EN.URB.MCTY               <dbl> 1239961, 1300299, 1358525, 1419444, 1482916,…
    ## $ EN.URB.MCTY.TL.ZS         <dbl> 11.79542, 12.44491, 13.16048, 13.67024, 13.8…
    ## $ FD.AST.PRVT.GD.ZS         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ FI.RES.TOTL.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ FI.RES.TOTL.MO            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ FI.RES.XGLD.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ FM.AST.DOMS.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ FM.AST.NFRG.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ FM.AST.PRVT.GD.ZS         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ FM.LBL.BMNY.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ FM.LBL.BMNY.GD.ZS         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ FM.LBL.BMNY.IR.ZS         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ FP.CPI.TOTL               <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ FP.CPI.TOTL.ZG            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ FP.WPI.TOTL               <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ FR.INR.LEND               <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ FR.INR.RISK               <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ FS.AST.CGOV.GD.ZS         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ FS.AST.PRVT.GD.ZS         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ IT.MLT.MAIN               <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ IT.MLT.MAIN.P2            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ MS.MIL.MPRT.KD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ MS.MIL.XPND.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ MS.MIL.XPND.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ MS.MIL.XPND.GD.ZS         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ MS.MIL.XPRT.KD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.CON.GOVT.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.CON.GOVT.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.CON.GOVT.KD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.CON.GOVT.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.CON.GOVT.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.CON.PRVT.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.CON.PRVT.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.CON.PRVT.KD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.CON.PRVT.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.CON.PRVT.PC.KD         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.CON.PRVT.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.CON.TOTL.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.CON.TOTL.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.CON.TOTL.KD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.CON.TOTL.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.CON.TOTL.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.DAB.DEFL.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.DAB.TOTL.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.DAB.TOTL.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.DAB.TOTL.KD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.DAB.TOTL.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.DAB.TOTL.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.EXP.GNFS.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.EXP.GNFS.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.EXP.GNFS.KD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.EXP.GNFS.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.EXP.GNFS.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.GDI.FPRV.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.GDI.FPRV.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.GDI.FTOT.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.GDI.FTOT.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.GDI.FTOT.KD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.GDI.FTOT.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.GDI.FTOT.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.GDI.STKB.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.GDI.STKB.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.GDI.STKB.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.GDI.TOTL.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.GDI.TOTL.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.GDI.TOTL.KD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.GDI.TOTL.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.GDI.TOTL.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.IMP.GNFS.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.IMP.GNFS.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.IMP.GNFS.KD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.IMP.GNFS.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.IMP.GNFS.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.RSB.GNFS.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.RSB.GNFS.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.RSB.GNFS.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.RSB.GNFS.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NE.TRD.GNFS.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NV.AGR.TOTL.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NV.AGR.TOTL.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NV.AGR.TOTL.KD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NV.AGR.TOTL.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NV.AGR.TOTL.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NV.IND.MANF.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NV.IND.MANF.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NV.IND.MANF.KD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NV.IND.MANF.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NV.IND.MANF.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NV.IND.TOTL.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NV.IND.TOTL.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NV.IND.TOTL.KD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NV.IND.TOTL.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NV.IND.TOTL.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NV.SRV.TOTL.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NV.SRV.TOTL.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NV.SRV.TOTL.KD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NV.SRV.TOTL.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NV.SRV.TOTL.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.EXP.CAPM.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GDP.DEFL.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GDP.DISC.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GDP.DISC.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GDP.FCST.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GDP.FCST.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GDP.FCST.KD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GDP.FCST.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GDP.MKTP.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GDP.MKTP.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GDP.MKTP.KD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GDP.MKTP.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GDP.PCAP.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GDP.PCAP.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GDP.PCAP.KD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GDP.PCAP.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GDS.TOTL.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GDS.TOTL.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GDS.TOTL.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GDY.TOTL.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GNP.MKTP.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GNP.MKTP.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GNP.MKTP.KD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GNP.MKTP.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GNP.PCAP.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GNP.PCAP.KD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GNP.PCAP.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GNS.ICTR.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GNS.ICTR.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GNS.ICTR.GN.ZS         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GNS.ICTR.ZS            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GSR.NFCY.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.GSR.NFCY.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.TAX.NIND.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.TAX.NIND.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.TAX.NIND.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.TRF.NCTR.CD            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.TRF.NCTR.CN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ NY.TTF.GNFS.KN            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ PA.NUS.ATLS               <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ PA.NUS.FCRF               <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SL.EMP.1524.SP.FE.NE.ZS   <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SL.EMP.1524.SP.MA.NE.ZS   <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SL.EMP.1524.SP.NE.ZS      <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SL.EMP.TOTL.SP.FE.NE.ZS   <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SL.EMP.TOTL.SP.MA.NE.ZS   <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SL.EMP.TOTL.SP.NE.ZS      <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SL.TLF.ACTI.1524.FE.NE.ZS <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SL.TLF.ACTI.1524.MA.NE.ZS <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SL.TLF.ACTI.1524.NE.ZS    <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SL.TLF.CACT.FE.NE.ZS      <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SL.TLF.CACT.FM.NE.ZS      <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SL.TLF.CACT.MA.NE.ZS      <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SL.TLF.CACT.NE.ZS         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SL.UEM.1524.FE.NE.ZS      <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SL.UEM.1524.MA.NE.ZS      <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SL.UEM.1524.NE.ZS         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SL.UEM.TOTL.FE.NE.ZS      <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SL.UEM.TOTL.MA.NE.ZS      <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SL.UEM.TOTL.NE.ZS         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SM.POP.REFG               <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SM.POP.REFG.OR            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ SP.POP.0004.FE.5Y         <dbl> 18.69252, 18.70449, 18.80564, 18.96147, 19.1…
    ## $ SP.POP.0004.MA.5Y         <dbl> 19.10245, 19.22218, 19.39854, 19.61460, 19.8…
    ## $ SP.POP.0014.FE.IN         <dbl> 2418669, 2410715, 2387348, 2406727, 2479055,…
    ## $ SP.POP.0014.FE.ZS         <dbl> 46.28430, 46.29515, 46.33243, 46.38973, 46.4…
    ## $ SP.POP.0014.MA.IN         <dbl> 2503414, 2497014, 2474639, 2496483, 2573329,…
    ## $ SP.POP.0014.MA.ZS         <dbl> 47.35447, 47.64231, 47.86435, 48.05181, 48.2…
    ## $ SP.POP.0014.TO            <dbl> 4922083, 4907729, 4861986, 4903210, 5052384,…
    ## $ SP.POP.0014.TO.ZS         <dbl> 46.82248, 46.97092, 47.09968, 47.22135, 47.3…
    ## $ SP.POP.0509.FE.5Y         <dbl> 14.96966, 14.93046, 14.85842, 14.77723, 14.7…
    ## $ SP.POP.0509.MA.5Y         <dbl> 15.34584, 15.39656, 15.37839, 15.32852, 15.2…
    ## $ SP.POP.1014.FE.5Y         <dbl> 12.62212, 12.66020, 12.66836, 12.65103, 12.6…
    ## $ SP.POP.1014.MA.5Y         <dbl> 12.90618, 13.02357, 13.08742, 13.10869, 13.0…
    ## $ SP.POP.1519.FE.5Y         <dbl> 10.497468, 10.553345, 10.587261, 10.604869, …
    ## $ SP.POP.1519.MA.5Y         <dbl> 10.58922, 10.69162, 10.77717, 10.84414, 10.8…
    ## $ SP.POP.1564.FE.IN         <dbl> 2679666, 2671512, 2642480, 2658113, 2728782,…
    ## $ SP.POP.1564.FE.ZS         <dbl> 51.27881, 51.30348, 51.28389, 51.23521, 51.1…
    ## $ SP.POP.1564.MA.IN         <dbl> 2665856, 2630179, 2584447, 2588283, 2651905,…
    ## $ SP.POP.1564.MA.ZS         <dbl> 50.42721, 50.18307, 49.98826, 49.81875, 49.6…
    ## $ SP.POP.1564.TO            <dbl> 5345522, 5301692, 5226926, 5246397, 5380687,…
    ## $ SP.POP.1564.TO.ZS         <dbl> 50.85055, 50.74146, 50.63498, 50.52648, 50.4…
    ## $ SP.POP.2024.FE.5Y         <dbl> 8.616708, 8.663076, 8.699960, 8.728348, 8.74…
    ## $ SP.POP.2024.MA.5Y         <dbl> 8.404983, 8.433139, 8.485538, 8.549401, 8.61…
    ## $ SP.POP.2529.FE.5Y         <dbl> 7.048041, 7.078215, 7.100540, 7.119154, 7.13…
    ## $ SP.POP.2529.MA.5Y         <dbl> 6.744039, 6.715182, 6.700382, 6.698167, 6.71…
    ## $ SP.POP.3034.FE.5Y         <dbl> 5.744641, 5.781529, 5.793271, 5.802987, 5.80…
    ## $ SP.POP.3034.MA.5Y         <dbl> 5.518304, 5.497162, 5.467217, 5.439207, 5.41…
    ## $ SP.POP.3539.FE.5Y         <dbl> 5.141255, 5.009263, 4.887602, 4.780390, 4.71…
    ## $ SP.POP.3539.MA.5Y         <dbl> 4.812209, 4.666669, 4.554083, 4.484680, 4.43…
    ## $ SP.POP.4044.FE.5Y         <dbl> 4.175486, 4.223497, 4.271967, 4.298475, 4.27…
    ## $ SP.POP.4044.MA.5Y         <dbl> 4.175943, 4.139964, 4.091742, 4.007604, 3.91…
    ## $ SP.POP.4549.FE.5Y         <dbl> 3.416188, 3.390431, 3.362891, 3.345961, 3.34…
    ## $ SP.POP.4549.MA.5Y         <dbl> 3.478417, 3.425419, 3.373005, 3.327444, 3.29…
    ## $ SP.POP.5054.FE.5Y         <dbl> 2.783380, 2.770049, 2.761909, 2.750662, 2.73…
    ## $ SP.POP.5054.MA.5Y         <dbl> 2.826526, 2.787422, 2.756461, 2.728010, 2.69…
    ## $ SP.POP.5559.FE.5Y         <dbl> 2.204230, 2.192405, 2.182615, 2.173452, 2.16…
    ## $ SP.POP.5559.MA.5Y         <dbl> 2.251386, 2.215136, 2.178610, 2.143695, 2.11…
    ## $ SP.POP.6064.FE.5Y         <dbl> 1.651412, 1.641675, 1.635877, 1.630908, 1.62…
    ## $ SP.POP.6064.MA.5Y         <dbl> 1.626186, 1.611358, 1.604048, 1.596403, 1.58…
    ## $ SP.POP.6569.FE.5Y         <dbl> 1.142368, 1.130352, 1.124645, 1.122047, 1.12…
    ## $ SP.POP.6569.MA.5Y         <dbl> 1.0804321, 1.0637990, 1.0532275, 1.0463681, …
    ## $ SP.POP.65UP.FE.IN         <dbl> 127344, 125045, 122823, 123220, 126772, 1270…
    ## $ SP.POP.65UP.FE.ZS         <dbl> 2.436889, 2.401362, 2.383676, 2.375069, 2.37…
    ## $ SP.POP.65UP.MA.IN         <dbl> 117272, 113975, 111022, 110633, 113325, 1131…
    ## $ SP.POP.65UP.MA.ZS         <dbl> 2.218321, 2.174610, 2.147392, 2.129442, 2.12…
    ## $ SP.POP.65UP.TO            <dbl> 244616, 239021, 233845, 233853, 240097, 2402…
    ## $ SP.POP.65UP.TO.ZS         <dbl> 2.326972, 2.287619, 2.265335, 2.252168, 2.24…
    ## $ SP.POP.7074.FE.5Y         <dbl> 0.7156391, 0.7039385, 0.6974955, 0.6938720, …
    ## $ SP.POP.7074.MA.5Y         <dbl> 0.6485335, 0.6352496, 0.6263989, 0.6199813, …
    ## $ SP.POP.7579.FE.5Y         <dbl> 0.3730042, 0.3654888, 0.3621146, 0.3607803, …
    ## $ SP.POP.7579.MA.5Y         <dbl> 0.3198404, 0.3118675, 0.3083108, 0.3067329, …
    ## $ SP.POP.80UP.FE.5Y         <dbl> 0.2058776, 0.2015834, 0.1994217, 0.1983689, …
    ## $ SP.POP.80UP.MA.5Y         <dbl> 0.1695153, 0.1636944, 0.1594551, 0.1563595, …
    ## $ SP.POP.DPND               <dbl> 96.65471, 97.07750, 97.49193, 97.91602, 98.3…
    ## $ SP.POP.DPND.OL            <dbl> 4.576092, 4.508391, 4.473853, 4.457402, 4.46…
    ## $ SP.POP.DPND.YG            <dbl> 92.07862, 92.56911, 93.01808, 93.45862, 93.8…
    ## $ SP.POP.TOTL               <dbl> 10512221, 10448442, 10322758, 10383460, 1067…
    ## $ SP.POP.TOTL.FE.IN         <dbl> 5225679, 5207273, 5152650, 5188060, 5334609,…
    ## $ SP.POP.TOTL.FE.ZS         <dbl> 49.71051, 49.83779, 49.91544, 49.96466, 49.9…
    ## $ SP.POP.TOTL.MA.IN         <dbl> 5286542, 5241168, 5170108, 5195399, 5338559,…
    ## $ SP.POP.TOTL.MA.ZS         <dbl> 50.28949, 50.16220, 50.08456, 50.03534, 50.0…
    ## $ SP.RUR.TOTL               <dbl> 8515214, 8395637, 8225793, 8203141, 8422410,…
    ## $ SP.RUR.TOTL.ZS            <dbl> 81.003, 80.353, 79.686, 79.002, 78.912, 78.8…
    ## $ SP.URB.TOTL               <dbl> 1997007, 2052805, 2096965, 2180319, 2250758,…
    ## $ SP.URB.TOTL.IN.ZS         <dbl> 18.997, 19.647, 20.314, 20.998, 21.088, 21.1…
    ## $ TG.VAL.TOTL.GD.ZS         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ TM.VAL.INSF.ZS.WT         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ TM.VAL.MRCH.CD.WT         <dbl> 1194000000, 1404000000, 996000000, 900000000…
    ## $ TM.VAL.OTHR.ZS.WT         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ TM.VAL.SERV.CD.WT         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ TM.VAL.TRAN.ZS.WT         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ TM.VAL.TRVL.ZS.WT         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ TX.VAL.INSF.ZS.WT         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ TX.VAL.MRCH.CD.WT         <dbl> 567000000, 552000000, 512000000, 395000000, …
    ## $ TX.VAL.OTHR.ZS.WT         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ TX.VAL.SERV.CD.WT         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ TX.VAL.TRAN.ZS.WT         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
    ## $ TX.VAL.TRVL.ZS.WT         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …

Our two new formats of `wdi` show a typical contrast between long and
wide datasets, which many rows in the long format and many columns and
in the wide format. In regards to `wdi_wide`, we can see that many
consecutive NAs values have been introduced into the dataset. This
probably happened when we transferred the `indicator_code` to the column
names, which may mean that there are certain countries which don’t have
values for all 277 indicators available. Let’s check how many unique
indicators are available in the `wdi_long` dataset first:
